<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fête du Seeee 2025 im Strandbad Tegelsee | Kulturinsel Moabit</title>
  <meta name="description" content="Erlebe das ehrenamtliche Musikfestival Fête du Seeee am 29.–30.08.2025 im Strandbad Tegelsee. Jetzt Programm entdecken!" />
  <link rel="canonical" href="https://kulturinselmoabit.org/fete/" />
  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Rubik+Dirt&display=swap" rel="stylesheet">
  <!-- CSS -->
  <link rel="stylesheet" href="/styles.css?v=simple-banner" />
</head>
<body class="fete-page">

  <!-- HEADER -->
  <header id="site-header">
    <div class="container header-inner">
      <div class="logo"><img src="/logo.svg" alt="Logo Kulturinsel Moabit" /></div>
      <nav class="site-nav">
        <button class="menu-toggle" aria-label="Menü öffnen / schließen"><span></span><span></span><span></span></button>
        <ul>
          <li><a href="/">Startseite</a></li>
          <li><a href="/fete/" class="active">Fête du Seeee</a></li>
          <li><a href="/jam/">Jamsession</a></li>
          <li><a href="/mitmachen/">Mitmachen</a></li>
          <li><a href="/uber-uns/">Über uns</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main>
    <section class="container page-inner page-inner--wide">
      <div class="page-text">

        <!-- Banner -->
        <section class="fete-banner" aria-label="Festival-Banner">
          <img class="fete-banner-img" src="fete-banner.svg" alt="Fête du Seeee – Banner" />
        </section>

        <!-- Meta -->
        <div class="fete-meta">
          <span>Strandbad Tegelsee</span>
          <span class="sep">•</span>
          <span>29. &amp; 30. August 2025</span>
        </div>

        <!-- Intro -->
        <section class="info-block">
          <p>Dieses Jahr wird unsere Fête du Seeee noch bunter und größer:
            Wir feiern an zwei Tagen auf gleich <strong>zwei Bühnen</strong> im wunderschönen
            Strandbad Tegelsee! Freut euch auf ein vielseitiges Programm aus Musik, Theater und Kunst,
            das von ehrenamtlichen Künstler*innen für euch gestaltet wird.</p>
          <p>Genießt tagsüber Kultur-Highlights und bunte Aktionen für Groß und Klein direkt am Wasser,
            und lasst euch abends von mitreißenden Konzerten und Performances auf beiden Bühnen mitreißen.
            Bei den unterschiedlichsten Genres ist für jeden Geschmack etwas dabei!</p>
        </section>

        <!-- SLIDESHOW -->
        <section class="fete-hero">
          <div class="fete-slider" id="feteSlider" aria-label="Festival-Impressionen">
            <button class="fete-control prev" aria-label="Vorheriges">‹</button>
            <button class="fete-control next" aria-label="Nächstes">›</button>
            <div class="fete-dots" role="tablist" aria-label="Slideshow-Navigation"></div>
          </div>
          <noscript><img src="1.jpg" alt="Festivalbild 1" style="width:100%;height:auto;border-radius:8px;display:block;margin-top:.5rem;"></noscript>
        </section>

        <!-- ===== LINE-UP (CSV) ===== -->
        <section class="lineup" id="lineup">
          <div class="lineup-wrap">
            <div class="lineup-heading">Line-Up</div>
            <div class="lu-root" aria-live="polite"></div>
          </div>

          <!-- Details-Dialog -->
          <dialog id="luModal" aria-label="Details">
            <button type="button" class="lu-close" aria-label="Schließen">×</button>
            <div class="lu-media-wrap" hidden><img class="lu-media" alt="" loading="lazy" /></div>
            <h3 class="lu-title"></h3>
            <div class="lu-time"></div>
            <div class="lu-desc"></div>
          </dialog>
        </section>
        <!-- ===== /LINE-UP ===== -->

        <!-- Eintritt -->
        <section class="entry">
          <h2 class="section-title">Eintritt</h2>
          <p><strong>nur Strandbadeintritt:</strong></p>
          <ul>
            <li>Erwachsene: 6 €</li>
            <li>Ermäßigt: 4 €</li>
            <li>Ab 18 Uhr: 2,50 €</li>
          </ul>
          <p>Kommt vorbei, bringt eure Freund*innen mit und lasst uns gemeinsam am
            Tegeler See feiern – wir freuen uns auf euch!</p>
        </section>

      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer id="site-footer">
    <div class="container footer-inner">
      <p><a href="/impressum.html">Impressum</a> | <a href="/kontakt.html">Kontakt</a> | <a href="/datenschutz.html">Datenschutz</a></p>
      <p>© 2025 Kulturinsel Moabit – alle Rechte vorbehalten</p>
    </div>
  </footer>

  <!-- JS: Burger-Menü -->
  <script>
    (function(){
      var btn=document.querySelector('.menu-toggle');
      var nav=document.querySelector('.site-nav ul');
      if(btn && nav){
        btn.addEventListener('click', function(){
          nav.classList.toggle('open');
          btn.classList.toggle('open');
        });
      }
    })();
  </script>

  <!-- JS: Slideshow (unverändert) -->
  <script>
  (function(){
    var slider=document.getElementById('feteSlider');
    if(!slider) return;

    var prevBtn=slider.querySelector('.fete-control.prev');
    var nextBtn=slider.querySelector('.fete-control.next');
    var dotsWrap=slider.querySelector('.fete-dots');

    function mk(tag,cls,txt){
      var el=document.createElement(tag);
      if(cls) el.className=cls;
      if(txt!=null) el.textContent=txt;
      return el;
    }
    if(!prevBtn){ prevBtn=mk('button','fete-control prev','‹'); prevBtn.setAttribute('aria-label','Vorheriges'); slider.appendChild(prevBtn); }
    if(!nextBtn){ nextBtn=mk('button','fete-control next','›'); nextBtn.setAttribute('aria-label','Nächstes'); slider.appendChild(nextBtn); }
    if(!dotsWrap){ dotsWrap=mk('div','fete-dots'); dotsWrap.setAttribute('role','tablist'); dotsWrap.setAttribute('aria-label','Slideshow-Navigation'); slider.appendChild(dotsWrap); }

    function folderPath(){
      var p=location.pathname;
      if(p.slice(-1)==='/') return p;
      if(/\/index\.html?$/i.test(p)) return p.replace(/index\.html?$/i,'');
      if(p.indexOf('.')>-1) return p.replace(/[^/]+$/,'');
      return p+'/';
    }
    var base=location.origin+folderPath();

    function loadImage(url){
      return new Promise(function(resolve){
        var img=new Image();
        img.onload=function(){ resolve({ok:true,node:img}); };
        img.onerror=function(){ resolve({ok:false}); };
        img.decoding='async';
        img.src=url;
      });
    }
    function loadVideo(url){
      return new Promise(function(resolve){
        var v=document.createElement('video');
        v.preload='metadata'; v.muted=true; v.playsInline=true; v.setAttribute('playsinline',''); v.loop=true;
        function ok(){ cleanup(); resolve({ok:true,node:v}); }
        function err(){ cleanup(); resolve({ok:false}); }
        function cleanup(){ v.removeEventListener('loadedmetadata',ok); v.removeEventListener('error',err); }
        v.addEventListener('loadedmetadata', ok);
        v.addEventListener('error', err);
        v.src=url;
      });
    }
    function probe(n){
      var jpg=base+n+'.jpg';
      return loadImage(jpg).then(function(r){
        if(r.ok){ r.node.alt='Festivalbild '+n; return {idx:n,node:r.node}; }
        var mp4=base+n+'.mp4';
        return loadVideo(mp4).then(function(r2){ return r2.ok ? {idx:n,node:r2.node} : null; });
      });
    }

    (function init(){
      Promise.all(Array.from({length:9},function(_,i){return probe(i+1);})).then(function(results){
        var items=results.filter(Boolean).sort(function(a,b){return a.idx-b.idx;});
        if(!items.length) return;

        var slides=[], dots=[];
        function addSlide(node, i){
          var wrap=mk('div','fete-slide');
          wrap.setAttribute('data-index', i);
          wrap.setAttribute('aria-hidden','true');
          wrap.appendChild(node);
          slider.insertBefore(wrap, dotsWrap);

          var dot=mk('button','fete-dot');
          dot.type='button';
          dot.setAttribute('aria-label','Slide '+(i+1));
          dotsWrap.appendChild(dot);

          slides.push(wrap); dots.push(dot);
        }
        items.forEach(function(it,i){ addSlide(it.node,i); });

        slider.appendChild(prevBtn);
        slider.appendChild(nextBtn);
        slider.appendChild(dotsWrap);

        var current=0;
        function show(i){
          current=(i+slides.length)%slides.length;
          slides.forEach(function(el,idx){
            var active=idx===current;
            el.classList.toggle('active',active);
            el.setAttribute('aria-hidden',active?'false':'true');
            var v=el.querySelector('video');
            if(v){ active ? v.play().catch(function(){}) : v.pause(); }
          });
          dots.forEach(function(d,idx){ d.classList.toggle('active', idx===current); });
        }

        prevBtn.addEventListener('click', function(){ show(current-1); });
        nextBtn.addEventListener('click', function(){ show(current+1); });

        slider.setAttribute('tabindex','0');
        slider.addEventListener('keydown', function(e){
          if(e.key==='ArrowLeft') show(current-1);
          if(e.key==='ArrowRight') show(current+1);
        });

        var sx=null;
        slider.addEventListener('touchstart', function(e){ sx=e.touches[0].clientX; }, {passive:true});
        slider.addEventListener('touchend', function(e){
          if(sx==null) return;
          var dx=e.changedTouches[0].clientX - sx;
          if(Math.abs(dx)>40) (dx<0 ? show(current+1) : show(current-1));
          sx=null;
        }, {passive:true});

        show(0);

        var timer=null, hover=false;
        function next(){ nextBtn.click(); }
        function start(){ if(!timer && slides.length>1) timer=setInterval(function(){ if(!hover && !document.hidden) next(); }, 5000); }
        function stop(){ clearInterval(timer); timer=null; }
        slider.addEventListener('mouseenter',function(){ hover=true; });
        slider.addEventListener('mouseleave',function(){ hover=false; });
        slider.addEventListener('touchstart', function(){ hover=true; }, {passive:true});
        slider.addEventListener('touchend', function(){ hover=false; }, {passive:true});
        document.addEventListener('visibilitychange', function(){ document.hidden ? stop() : start(); });
        start();
      });
    })();
  })();
  </script>

  <!-- PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- CSV → Line-up Renderer -->
  <script>
  (function(){
    var CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vRkYgQhBk53GOGABV_qzv3ZqjgSfR61ZH9_fX-uejRTUOQ4EtAgARUXXIayqaPKWRr5hBRMCH219-_j/pub?output=csv";
    var IMG_BASE="";

    var wrap=document.querySelector('.lineup .lineup-wrap');
    var root=document.querySelector('.lineup .lu-root');
    if(!wrap||!root) return;

    function norm(s){return (s==null?"":String(s)).trim();}
    function lc(s){return norm(s).toLowerCase();}
    function pick(obj,keys){
      var map={}; Object.keys(obj||{}).forEach(function(k){ map[lc(k)]=obj[k]; });
      for(var i=0;i<keys.length;i++){ var kk=lc(keys[i]); if(map.hasOwnProperty(kk)) return norm(map[kk]); }
      var want=keys.map(function(k){return lc(k);});
      for(var k in map){ if(!map.hasOwnProperty(k)) continue; for(var j=0;j<want.length;j++){ if(k.indexOf(want[j])!==-1) return norm(map[k]); } }
      return "";
    }
    function timeToMinutes(str){
      var s=lc(str).replace(/[^\d:.,-]/g,"").replace(",",":").replace(".",":");
      var m=s.match(/(\d{1,2})[:.]?(\d{2})?/); if(!m) return Number.POSITIVE_INFINITY;
      var h=parseInt(m[1],10), mm=m[2]?parseInt(m[2],10):0;
      if(isNaN(h)||isNaN(mm)) return Number.POSITIVE_INFINITY;
      return h*60+mm;
    }
    function fmtTime(start,end){ var s=norm(start), e=norm(end); if(!s&&!e) return ""; if(s&&!e) return s; if(!s&&e) return e; return s+"–"+e; }
    function normalizeDayLabel(dayRaw){
      var d=lc(dayRaw); if(!d) return norm(dayRaw);
      if(["fr","fr.","fri","fre","freitag","friday"].indexOf(d)!==-1) return "FR. 29. AUGUST";
      if(["sa","sa.","sam","samstag","sat","saturday"].indexOf(d)!==-1) return "SA. 30. AUGUST";
      return norm(dayRaw);
    }
    function imgURL(v){
      var u=norm(v); if(!u) return "";
      if(/^https?:\/\//i.test(u) || /^\/|^data:/i.test(u)) return u;
      var base=norm(IMG_BASE); if(!base) return u;
      return (base.charAt(base.length-1)==='/'?base:base+'/') + u.replace(/^\/+/,"");
    }

    // Fallback-Blöcke entfernen
    Array.prototype.forEach.call(wrap.querySelectorAll('.line'), function(n){ if(n.parentNode) n.parentNode.removeChild(n); });

    // Dialog
    var dlg=document.getElementById('luModal');
    var dlgClose=dlg?dlg.querySelector('.lu-close'):null;
    var dlgImgWrap=dlg?dlg.querySelector('.lu-media-wrap'):null;
    var dlgImg=dlg?dlg.querySelector('.lu-media'):null;
    var dlgTitle=dlg?dlg.querySelector('.lu-title'):null;
    var dlgTime=dlg?dlg.querySelector('.lu-time'):null;
    var dlgDesc=dlg?dlg.querySelector('.lu-desc'):null;

    function openModal(p){
      if(!dlg) return;
      var title=p&&p.title||"", time=p&&p.time||"", desc=p&&p.desc||"", image=p&&p.image||"";
      if(dlgTitle) dlgTitle.textContent=title;
      if(dlgTime) dlgTime.textContent=time;
      if(dlgImgWrap && dlgImg){
        if(image){ dlgImgWrap.hidden=false; dlgImg.src=image; dlgImg.alt=title||""; }
        else { dlgImg.src=""; dlgImg.alt=""; dlgImgWrap.hidden=true; }
      }
      if(dlgDesc){
        dlgDesc.textContent="";
        if(desc){
          var parts=desc.split(/\r?\n/);
          for(var i=0;i<parts.length;i++){
            if(i) dlgDesc.appendChild(document.createElement('br'));
            dlgDesc.appendChild(document.createTextNode(parts[i]));
          }
        }
      }
      try{ dlg.showModal(); }catch(e){ dlg.setAttribute('open',''); }
      setTimeout(function(){ if(dlgClose) dlgClose.focus(); },0);
    }
    function closeModal(){ if(dlg && dlg.close) dlg.close(); if(dlg) dlg.removeAttribute('open'); }
    if(dlgClose) dlgClose.addEventListener('click', closeModal);
    if(dlg){
      dlg.addEventListener('cancel', function(e){ e.preventDefault(); closeModal(); });
      dlg.addEventListener('click', function(e){
        var r=dlg.getBoundingClientRect();
        if(e.clientX<r.left||e.clientX>r.right||e.clientY<r.top||e.clientY>r.bottom) closeModal();
      });
    }

    function renderDayBlock(dayLabel, acts){
      var day=document.createElement('div'); day.className='line';
      var tag=document.createElement('div'); tag.className='lineup-daytag'; tag.textContent=dayLabel; day.appendChild(tag);
      var ul=document.createElement('ul'); ul.className='acts'; ul.setAttribute('aria-label','Line-up '+dayLabel);
      acts.forEach(function(a){
        var li=document.createElement('li');
        var btn=document.createElement('button'); btn.type='button'; btn.className='lu-act'; btn.setAttribute('aria-haspopup','dialog');
        btn.textContent=a.artist||"–";
        btn.addEventListener('click', function(){ openModal({ title:a.artist, time:fmtTime(a.start,a.end), desc:a.description, image:a.image }); });
        li.appendChild(btn); ul.appendChild(li);
      });
      day.appendChild(ul);
      return day;
    }

    fetch(CSV_URL,{cache:'no-store'})
      .then(function(res){ return res.text(); })
      .then(function(text){
        var parsed=Papa.parse(text,{header:true,skipEmptyLines:true});
        var rows=(parsed.data||[]).filter(function(r){
          var ok=false; Object.keys(r).forEach(function(k){ if(norm(r[k])) ok=true; }); return ok;
        });
        if(!rows.length) return;

        var groups=[], byKey={};
        var DAY_KEYS=["day","tag","wochentag","datum"], START_KEYS=["start","startzeit","beginn"], END_KEYS=["end","ende","endzeit"], ART_KEYS=["artist","band","name","bandname"], DESC_KEYS=["description","beschreibung","text","info"], IMG_KEYS=["image","bild","bildurl","foto","image_url","url"];

        rows.forEach(function(row){
          var artist=pick(row,ART_KEYS); if(!artist) return;
          var dayRaw=pick(row,DAY_KEYS)||"", start=pick(row,START_KEYS), end=pick(row,END_KEYS), description=pick(row,DESC_KEYS), image=imgURL(pick(row,IMG_KEYS));
          var key=lc(dayRaw)||"lineup";
          if(!byKey[key]){ var label=normalizeDayLabel(dayRaw||"Line-up"); byKey[key]={key:key,label:label,items:[]}; groups.push(byKey[key]); }
          byKey[key].items.push({ artist:artist, start:start, end:end, description:description, image:image, t:timeToMinutes(start) });
        });

        groups.forEach(function(g){ g.items.sort(function(a,b){ return a.t-b.t; }); });
        groups.forEach(function(g){ root.appendChild(renderDayBlock(g.label,g.items)); });

        // nach dem Rendern: Separatoren berechnen
        setTimeout(function(){ window.dispatchEvent(new Event('resize')); },0);
      })
      .catch(function(err){ console.error(err); });
  })();
  </script>

  <!-- JS: Line-up – Punkte nur am echten Zeilenanfang (Centerline-Messung) -->
  <script>
  (function () {
    function computeStartsByCenter(ul) {
      var items = Array.prototype.slice.call(ul.children);
      var starts = [];
      var lastCenter = null;
      var TOL = 4; // px – kleine Abweichungen erlauben

      for (var i=0;i<items.length;i++){
        var r = items[i].getBoundingClientRect();
        var center = Math.round(r.top + r.height/2);
        if (i===0 || lastCenter===null || Math.abs(center - lastCenter) > TOL) {
          starts.push(i);
          lastCenter = center;
        }
      }
      return starts;
    }

    function applyStarts(ul, starts){
      var items = Array.prototype.slice.call(ul.children);
      items.forEach(function(li){ li.classList.remove('row-start'); });
      starts.forEach(function(idx){ if(items[idx]) items[idx].classList.add('row-start'); });
    }

    function eq(a,b){
      if(a.length!==b.length) return false;
      for(var i=0;i<a.length;i++){ if(a[i]!==b[i]) return false; }
      return true;
    }

    function updateLineupSeparators() {
      var lists=document.querySelectorAll('.lineup .acts');
      Array.prototype.forEach.call(lists, function(ul){
        var s1 = computeStartsByCenter(ul);
        applyStarts(ul, s1);
        // stabilisieren (falls das Entfernen eines Punktes die Zeilen ändert)
        var s2 = computeStartsByCenter(ul);
        if(!eq(s1,s2)){ applyStarts(ul, s2); }
      });
    }

    var deb=(function(){var id; return function(){ cancelAnimationFrame(id); id=requestAnimationFrame(updateLineupSeparators); };})();
    window.addEventListener('load', updateLineupSeparators);
    window.addEventListener('resize', deb);
    window.addEventListener('orientationchange', deb);
    if (document.fonts && document.fonts.ready) { document.fonts.ready.then(updateLineupSeparators); }
    // Safety: nach CSV-Render wird ein resize-Event getriggert; hier nochmal als Backup:
    setTimeout(updateLineupSeparators, 500);
  })();
  </script>
</body>
</html>
